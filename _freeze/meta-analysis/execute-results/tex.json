{
  "hash": "16013562ae115a20e64dadf3d64c0c9c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Meta-Analysis\"\nshare:\n  permalink: \"https://book.martinez.fyi/meta-analysis.html\"\n  description: \"Business Data Science: What Does it Mean to Be Data-Driven?\"\n  linkedin: true\n  email: true\n  mastodon: true\n---\n\n\n\nBayesian meta-analysis is a statistical method that combines information from\nmultiple studies to estimate the overall effect size of an intervention or\nvariable of interest. Bayesian methods incorporate prior information into the\nanalysis, updating these beliefs with new data to produce posterior\ndistributions. This approach provides a flexible and dynamic means of\nintegrating evidence, allowing for more informed and adaptive decision-making.\n\nImagine having access to a wealth of findings from various studies that have\nexplored the impact of a specific intervention on your company's sales. Each\nstudy offers an estimate of the effect size, but these estimates might differ\ndue to variations in sample size, study design, and other contributing factors.\nBayesian meta-analysis steps in to harmonize these disparate estimates into a\nunified overall effect size. It adeptly takes into account the relative\nprecision and reliability of each study, ensuring a balanced and informed\nassessment. Furthermore, with sufficient data, this methodology allows you to\ndelve deeper and estimate the probability that specific study characteristics\nare driving heterogeneity in the observed impact of the intervention.\n\n## A Simple Example Using Synthetic Data\n\nLet's ground this concept with a practical scenario. Suppose your objective is\nto estimate the incremental lift of an intervention, and you have access to\nmultiple studies that have investigated its effects. Faced with a variety of\nestimates, how would you determine which one to rely on for your\ndecision-making? While you might be tempted to simply choose the number you\nprefer, mentally combine the estimates, or calculate a simple average, a more\nrigorous approach is to conduct a Bayesian meta-analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\nstudies <- tibble(\n  study = LETTERS[1:5],\n  lift_hat = c(0.09, 0.06, 0.06, 0.07, 0.04),\n  std_err = c(0.01, 0.01, 0.007, 0.007, 0.01)\n) %>%\n  mutate(\n    LB = lift_hat - 1.96 * std_err,\n    UB = lift_hat + 1.96 * std_err\n  )\n```\n:::\n\n\n\n::: {.content-visible when-format=\"pdf\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = studies, aes(x = study, y = lift_hat)) +\n  geom_pointrange(aes(\n    ymin = LB,\n    ymax = UB\n  )) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  ylab(\"Lift\") +\n  xlab(\"Study\") +\n  theme_bw(base_size = 20)\n```\n\n::: {.cell-output-display}\n![](meta-analysis_files/figure-pdf/static-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n::: \n\n::: {.content-visible when-format=\"html\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggiraph)\n\ntooltip_css <-\n  \"background-color:gray;color:white;font-style:italic;padding:10px;border-radius:5px;font-size:16px;\"\n\n\nstudies <- studies %>%\n  mutate(\n    tooltip = glue::glue(\n      \"lift is {scales::percent(lift_hat)} with a 95% confidence interval between {scales::percent(LB, accuracy=1)} and {scales::percent(UB, accuracy=1)}\"\n    )\n  )\n\nmy_plot <- ggplot(data = studies, aes(x = study, y = lift_hat)) +\n  geom_pointrange_interactive(aes(\n    ymin = LB,\n    ymax = UB,\n    tooltip = tooltip\n  )) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  ylab(\"Lift\") +\n  xlab(\"Study\") +\n  theme_bw(base_size = 20)\n\ngirafe(\n  code = print(my_plot),\n  pointsize = 20,\n  width_svg = 7,\n  height_svg = 3.5,\n  options = list(opts_tooltip(css = tooltip_css))\n)\n```\n:::\n\n\n:::\n\nGiven these studies, what insights can you glean? Let's say you need to make a\ndecision based on whether the lift is at least 5%. Would you be able to\nconfidently determine the answer?\n\nTo address this, you can fit a straightforward model to the data:\n\n\n$$\n\\begin{aligned}\ny_i &\\sim N(\\theta_i,s_i)  \\\\\n\\theta_i &\\sim N(\\mu, \\tau) \\\\\n\\mu &\\sim N(0, 0.05) \\\\\n\\tau &\\sim N^+(0, 0.05) \n\\end{aligned}\n$$\nwhere:\n\n- $y_i$ is the estimated lift in study $i$\n\n- $s_i$ is the standard error of the lift in study $i$\n\n- $\\theta_i$ is the true lift in study $i$\n\n- $\\mu$ is the true lift in the population\n\n- $\\tau$ is the standard deviation in lift\n\nTo fit this model you can use `im::metaAnalysis()`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(im)\n\ntest_meta <- metaAnalysis$new(data = studies, point_estimates = lift_hat,\n                              standard_errors = std_err, id = study)\n```\n:::\n\n\n\nCalculating the probability that the lift is at least 5% becomes remarkably\nsimple:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_meta$probability(a = 0.05)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nThe probability that lift is more than 5% is 88%.\n```\n\n\n:::\n:::\n\n\n\n::: {.content-visible when-format=\"pdf\"}\nTo visualize the insights gained from the meta-analysis, you can plot the\nposterior by calling `test_meta$PlotLift`.\n::: \n\n::: {.content-visible when-format=\"html\"}\n\nTo visualize the insights gained from the meta-analysis, you can plot the\nposterior probability:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot the lift's prior and posterior distributions\ntest_meta$PlotLift(\n  breaks = c(0, 0.01, 0.05, 0.1),\n  break_names = c(\" < 0\", \"(0,1%)\", \"(1%,5%)\", \"(5%,10%)\", \"> 10%\"),\n  display_mode_name = TRUE\n)\n```\n:::\n\n\n::: \n\n## A more complex meta-anlysis\n\nLet's delve deeper into the realm of Bayesian meta-analysis by incorporating\nstudy-specific characteristics that can offer richer insights into the factors\ninfluencing the impact of interventions. Imagine that each study in your\ncollection comes with valuable metadata, such as the geographical location where\nthe intervention was implemented, the specific modality of the intervention, or\nany other relevant attribute. By weaving these details into our model, we can\nuncover whether the impact varies significantly across different locations or\nmodalities.\n\nTo achieve this, we can refine our model as follows:\n\n$$\n\\begin{aligned}\ny_i & \\sim N(\\theta_i,s_i)  \\\\\n\\theta_i & \\sim N(\\mu_i, \\tau) \\\\\n\\mu_i & = \\mu_0 + X\\beta\n\\end{aligned}\n$$\n\nIn this augmented model $X$ is a matrix of study-specific characteristics. By\nfitting this model, we can not only estimate the overall effect size but also\ndiscern whether the impact is significantly higher or lower for specific\nlocations, modalities, or any other characteristic captured in the metadata.\nThis granular understanding allows for more targeted decision-making, enabling\nyou to tailor interventions to specific contexts and maximize their\neffectiveness.\n\nHowever, it is crucial to remember that the quality of your meta-analysis hinges\non the quality of the data you feed into it. As with any statistical model, the\nadage \"garbage in, garbage out\" holds true. If the underlying studies are flawed\nor biased, the meta-analysis will not magically erase those imperfections. For\ninstance, to conduct even a simple meta-analysis, you ideally need at least five\nhigh-quality randomized controlled trials (RCTs) to ensure robust results.\n\nIn essence, Bayesian meta-analysis acts as a versatile instrument, empowering\nyou to harmonize diverse sources of evidence, account for heterogeneity, and\nextract actionable insights from study-level characteristics. As you continue\nyour exploration of causal inference in the tech industry, remember that\nBayesian methods offer a robust framework for navigating uncertainty, optimizing\ninterventions, and driving impactful decisions that propel your company forward.\nHowever, the success of this endeavor rests on the foundation of sound data and\nrigorous study design.\n\n::: {.callout-tip}\n## Learn more\n@gelman2013bayesian Parallel Experiments in Eight Schools.\n::: ",
    "supporting": [
      "meta-analysis_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}